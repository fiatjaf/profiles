NIP-10
======

Proof of Work
-------------

`draft` `optional` `author:cerbwm`

A user may want to produce proof of work (POW) to call attention to a cetain event.
Similarly, to protect against denial of service attacks,
a relay may require that events come with a certain amount of POW. 
When a POW is available, it MAY be included in the event body under the `pow` key
as an array of two elemnt arrays, each containing the name of a
POW algorithm and a hex encoded POW nonce.

```
{
  id: ...,
  kind: ...,
  ...,
  ...,
  pow: [[<string name of POW algorithm>, <nonce, as a (lowercase) hex string>], ...]
}
```

Both clients and relays MAY validate the POW by
hashing the concatenation of the event id and the nonce
(after both are decoded from their hex representations).

The POW can be provided by relays, as a paid service, or
by the publishing users themselves when they first upload the event to relays.

## POW algorithms

There is one POW algorithm currently implemented.
When a new algorithm is introduced, it should be added below.

### `scrypt`

```
{
  id: ...,
  kind: ...,
  ...,
  ...,
  pow: [["scrypt", "828dc9e6cc5c24e0"]]
}
```

The scrypt key derivation function
as defined in Colin Percival's paper
"Stronger Key Derivation via Sequential Memory-Hard Functions"(https://www.tarsnap.com/scrypt/scrypt.pdf).

The current parameters are N=32768, r=8 and p=1.

## POW Vote Events

Using a new event with kind `6`,
clients MAY submit additional POW for other events.

The tag entry of kind `6` events MUST contain one "e" event id to upvote.
The `content` field of kind `6` events must contain a valid
`pow` field encoded as a stringified JSON array of arrays.

### Relay Usage

Relays MAY choose to store a single `pow` object for an event,
representing the largest work value for each algorithm,
and include that with subsequent messages to clients.
This is not required since relays may not have knowledge of all referenced events
or all POW algorithms.
Similarly, if a relay receives two events with identical `id`s
but different `pow` fields,
the relay MAY discard the lesser POWs.

### Client Usage

Clients MAY also validate kind `6` events and discard them
after updating the POW on the refered event if the new POW is better.
Clients MAY display the POW in any format, or not at all.

Note that the POW in kind `6` events, though signed,
only commits to the referenced event, not the kind `6` event itself.
Thus, any user can simply copy the content field of an existing
kind `6` event and submit their own event with the same amount of POW.
If a user wants to call attention to an event in a way that
commits their identity,
the user MAY add POW to a simple kind `1` `text_note`
that references the event they want to call attention to.
